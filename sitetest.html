<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>SiteTest</title>
<link rel="stylesheet" href="https://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.css"></link>
<script src="https://code.jquery.com/jquery-1.12.4.min.js"></script>
<script src="https://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.js"></script>
<style>
* {
  box-sizing: border-box;
}

body {
  font-family: Arial, Helvetica, sans-serif;
}

/* Style the header */
header {
  background-color: #666;
  padding: 30px;
  text-align: center;
  font-size: 35px;
  color: white;
}

/* Create two columns/boxes that floats next to each other */
nav {
  float: left;
  width: 25%;
  text-align: left;
  background: #ccc;
  padding: 5px;
}
article {
  float: left;
  padding: 20px;
  width: 50%;
  background-color: #f1f1f1;
}

/* Clear floats after the columns */
section::after {
  content: "";
  display: table;
  clear: both;
}

/* Style the footer */
footer {
  background-color: #777;
  padding: 10px;
  text-align: center;
  color: white;
}

/* Responsive layout - makes the two columns/boxes stack on top of each other instead of next to each other, on small screens */
@media (max-width: 800px) {
  nav, article {
    width: 100%;
    height: auto;
  }
}
</style>
<script>
//window.dataLayer = window.dataLayer || [];
function getValues(myText) {
   var lines = myText.split("\n");
   var numLines = lines.length;
   var i;
   var values = Array();
   for (i = 0; i < numLines; i++) {
     var line = lines[i];
     if (line != '') {
        value = line.split(' ')[1];
        values.push(value)
     }
   }
   return values;
}
function getNegativeValues(myText) {
   var lines = myText.split("\n");
   var numLines = lines.length;
   var i;
   var values = Array();
   for (i = 0; i < numLines; i++) {
     var line = lines[i];
     if (line != '') {
        value = line.split(' ')[1];
        values.push(-value)
     }
   }
   return values;
}

function getLabels(myText) {
   var lines = myText.split("\n");
   var numLines = lines.length;
   var i;
   var labels = Array();
   for (i = 0; i < numLines; i++) {
     var line = lines[i];
     if (line != '') {
        label = line.split(' ')[0];
        labels.push(label);
     }
   }
   return labels;
}

function getDomains() {
     url="sitetest.php";
     jQuery.ajaxSetup({async:false});
     domains = [];
     $.get( url, function( data ) {
        domains = getLabels(data);
     }); // end get
     jQuery.ajaxSetup({async:true});
     return domains;
}
function createTable(domain,card) {
   var $table = $("<table>", { 'border':'0' });
   var $thead = $("<thead>");
   var $tbody = $("<tbody>");
   $thead.append($('<th>', { 'text':domain, 'colspan':'2' }));
   for (const [key, value] of Object.entries(card)) {
      newTr = $('<tr>');
      newTr.append($('<td>', { 'text':key, }));
      newTr.append($('<td>', { 'text':value, }));
      $tbody.append(newTr);
   }
   $table.append($thead);
   $table.append($tbody);
   $table.appendTo("body");
   return $table;
}

function renderCard(card,domain) {
     url="sitetest.php?domain="+domain;
     $.get( url, function( data ) {
      json_card = JSON.parse(data)
      table_card=createTable(domain,json_card)
      $("#card-"+card).html(table_card);
     }); // end get
}

$(document).ready(function(){
   domains=getDomains();
   for (var card = 0; card < domains.length; card++) {
      domain=domains[card]
      renderCard(card,domain)
   }
   // overall stats
   renderCard(5,'stats')

}); // end of doc ready
</script>
</head>
<body>
<header>
Site Test Stats
</header>
<section>
  <nav><div id="card-0"></div></nav>
  <nav><div id="card-1"></div></nav>
  <nav><div id="card-2"></div></nav>
  <nav><div id="card-3"></div></nav>
  <article><div id="card-5"></article>
</section>
<footer>
<center>APR Digital Studios - Site Test Stats</center>
</footer>
</body>
</html>
